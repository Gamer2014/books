100 REM DICE
110 DIM A(12)
120 GOSUB 1100:LET G=0
130 FOR I=1 TO 12
140 LET X=1-INT(I/10):LET Y=I:GOSUB 1700:PRINT ;I
150 NEXT I
160 LET N=6:FOR I=1 TO 12:LET A(I)=0:NEXT I
170 LET X=0:LET Y=14:GOSUB 1700:PRINT "dice roll: "
180 LET G=G+1:GOSUB 1300:LET A=R:GOSUB 1300
190 LET X=13:LET Y=14:GOSUB 1700:PRINT ;A;"+";R
200 LET T=A+R:LET A(T)=A(T)+0.5:IF A(T)>17.5 THEN GOTO 220
210 LET X=A(T)+2.5:LET Y=T:GOSUB 1700:PRINT "*"
220 LET T=0.4:GOSUB 1400:IF G<180 THEN GOTO 180
230 LET T=6:GOSUB 1400
240 GOSUB 2800
250 LET X=4:LET Y=1:GOSUB 1700:PRINT "results":PRINT
260 FOR I=1 TO 11 STEP 2
270 PRINT ;I;" - ";2*A(I);TAB(10);I+1;" - ";2*A(I+1)
280 NEXT I
290 PRINT:STOP
1000 REM VIC20 SUBROUTINES
1100 W=20:D=23
1110 F=8:GOSUB 1200:RETURN
1200 PRINT CHR$(147)
1210 FOR LL=1 TO 8:PRINT:NEXT LL
1220 PRINT;
1230 RETURN
1300 R=INT(RND(1)*N+1):RETURN
1400 FOR Z=1 TO 1000*T:NEXT Z:RETURN
1500 GET G$:IF G$="" THEN 1500
1510 RETURN
1600 GET K$:RETURN
1700 PRINT CHR$(19)
1710 IF Y>0 THEN FOR LL=1 TO Y:PRINT CHR$(17);:NEXT LL
1720 IF X>0 THEN FOR LL=1 TO X:PRINT CHR$(29);:NEXT LL
1730 RETURN
1800 IF X>0 THEN FOR LL=1 TO X:PRINT CHR$(29);:NEXT LL
1810 RETURN
1900 PRINT CHR$(145);:RETURN
2000 PRINT CHR$(29);:RETURN
2100 INPUT K:RETURN
2200 INPUT K$:RETURN
2300 PRINT CHR$(147):RETURN
2400 POKE 36878,15:POKE 36876,Z+128
2410 FOR M=1 TO 50:NEXT M
2420 POKE 36876,0:RETURN
2500 R$=CHR$(R+64):RETURN
2600 P$=MID$(K$,P,1):RETURN
2700 GOSUB 2600:A=ASC(P$):RETURN
2800 PRINT CHR$(147):RETURN
2900 DIM V$(26):RETURN
3000 DIM W$(60):RETURN
3100 GG=ASC(G$):RETURN
