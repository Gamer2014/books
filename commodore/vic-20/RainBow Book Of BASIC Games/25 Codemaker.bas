100 REM CODES
110 DIM U(24)
120 GOSUB 1100
130 FOR I=1 TO 24:LET U(I)=0:NEXT I
140 LET X=0:LET Y=3:GOSUB 1700:PRINT "c = coding"
150 PRINT:PRINT "d = decoding"
160 PRINT:PRINT "press{space*2}c{space*2}or{space*2}d"
170 GOSUB 1500:IF G$<>"c" AND G$<>"d" THEN GOTO 170
180 LET H$=G$:GOSUB 2800:GOSUB 1700:PRINT "type in your message":PRINT
190 GOSUB 2200:LET L=LEN(K$):LET L$=K$
200 PRINT:PRINT "enter secret number":GOSUB 2100:LET C=0:LET G=0
210 LET K$=L$:IF H$="d" THEN GOTO 310
220 FOR I=1 TO K
230 LET G=G+1:IF G>L THEN LET G=1
240 IF U(G)>0 THEN GOTO 230
250 NEXT I
260 LET C=C+1:LET P=C:GOSUB 2700:LET U(G)=A
270 IF C<L THEN GOTO 220
280 GOSUB 2800:GOSUB 1700:PRINT "coded message is":PRINT
290 FOR I=1 TO L:LET R=U(I)-64:GOSUB 2500:PRINT R$;:NEXT I
300 GOTO 380
310 GOSUB 2800:GOSUB 1700:PRINT "decoded message is":PRINT
320 FOR I=1 TO K
330 LET G=G+1:IF G>L THEN LET G=1
340 IF U(G)>0 THEN GOTO 330
350 NEXT I
360 LET P=G:GOSUB 2600:PRINT P$;:LET U(G)=1
370 LET C=C+1:IF C<L THEN GOTO 320
380 PRINT:PRINT:STOP
1000 REM VIC20 SUBROUTINES
1100 W=20:D=23
1110 F=8:GOSUB 1200:RETURN
1200 PRINT CHR$(147)
1210 FOR LL=1 TO 8:PRINT:NEXT LL
1220 PRINT;
1230 RETURN
1300 R=INT(RND(1)*N+1):RETURN
1400 FOR Z=1 TO 1000*T:NEXT Z:RETURN
1500 GET G$:IF G$="" THEN 1500
1510 RETURN
1600 GET K$:RETURN
1700 PRINT CHR$(19)
1710 IF Y>0 THEN FOR LL=1 TO Y:PRINT CHR$(17);:NEXT LL
1720 IF X>0 THEN FOR LL=1 TO X:PRINT CHR$(29);:NEXT LL
1730 RETURN
1800 IF X>0 THEN FOR LL=1 TO X:PRINT CHR$(29);:NEXT LL
1810 RETURN
1900 PRINT CHR$(145);:RETURN
2000 PRINT CHR$(29);:RETURN
2100 INPUT K:RETURN
2200 INPUT K$:RETURN
2300 PRINT CHR$(147):RETURN
2400 POKE 36878,15:POKE 36876,Z+128
2410 FOR M=1 TO 50:NEXT M
2420 POKE 36876,0:RETURN
2500 R$=CHR$(R+64):RETURN
2600 P$=MID$(K$,P,1):RETURN
2700 GOSUB 2600:A=ASC(P$):RETURN
2800 PRINT CHR$(147):RETURN
2900 DIM V$(26):RETURN
3000 DIM W$(60):RETURN
3100 GG=ASC(G$):RETURN
