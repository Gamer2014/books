100 REM FRUIT
110 DIM F$(4)
120 FOR I=1 TO 4:READ F$(I):NEXT I
130 DATA "lemon","orange","cherry","lime"
140 LET M=10
150 GOSUB 1100
160 PRINT "{space*3}fruit machine"
170 LET T=2:GOSUB 1400
180 GOSUB 2800:PRINT:PRINT "{space*2}how much do you"
190 PRINT:PRINT "{space*2}want to bet? ";:GOSUB 2100
200 IF K<1 OR K>30 OR K<>INT(K) OR K>M THEN GOTO 180
210 LET T=2:GOSUB 1400:LET N=4:GOSUB 1300:LET R1=R:GOSUB 1300:LET R2=R:LET R3=R
220 PRINT:PRINT:PRINT F$(R1);" ";F$(R2);" ";F$(R3)
230 IF R1=R2 THEN GOTO 250
240 LET M$="lose":LET M=M-K:GOTO 270
250 IF R2<>R3 THEN LET M$="win $"+STR$(3*K):LET M=M+3*K:GOTO 270
260 LET M$="win $"+STR$(4*K):LET M=M+4*K
270 IF M$="lose" AND R1=3 THEN LET M$="win $"+STR$(K):LET M=M+2*K
280 PRINT:PRINT "{space*2}you ";M$;"!":PRINT:PRINT
290 IF M=0 THEN PRINT "sorry you're broke!":GOTO 320
300 IF M>100 THEN PRINT "you broke the bank!"
310 PRINT "you now have $";M:LET T=3:GOSUB 1400:IF M<=100 THEN GOTO 170
320 PRINT:PRINT:STOP
1000 REM VIC20 SUBROUTINES
1100 W=20:D=23
1110 F=8:GOSUB 1200:RETURN
1200 PRINT CHR$(147)
1210 FOR LL=1 TO 8:PRINT:NEXT LL
1220 PRINT;
1230 RETURN
1300 R=INT(RND(1)*N+1):RETURN
1400 FOR Z=1 TO 1000*T:NEXT Z:RETURN
1500 GET G$:IF G$="" THEN 1500
1510 RETURN
1600 GET K$:RETURN
1700 PRINT CHR$(19)
1710 IF Y>0 THEN FOR LL=1 TO Y:PRINT CHR$(17);:NEXT LL
1720 IF X>0 THEN FOR LL=1 TO X:PRINT CHR$(29);:NEXT LL
1730 RETURN
1800 IF X>0 THEN FOR LL=1 TO X:PRINT CHR$(29);:NEXT LL
1810 RETURN
1900 PRINT CHR$(145);:RETURN
2000 PRINT CHR$(29);:RETURN
2100 INPUT K:RETURN
2200 INPUT K$:RETURN
2300 PRINT CHR$(147):RETURN
2400 POKE 36878,15:POKE 36876,Z+128
2410 FOR M=1 TO 50:NEXT M
2420 POKE 36876,0:RETURN
2500 R$=CHR$(R+64):RETURN
2600 P$=MID$(K$,P,1):RETURN
2700 GOSUB 2600:A=ASC(P$):RETURN
2800 PRINT CHR$(147):RETURN
2900 DIM V$(26):RETURN
3000 DIM W$(60):RETURN
3100 GG=ASC(G$):RETURN
