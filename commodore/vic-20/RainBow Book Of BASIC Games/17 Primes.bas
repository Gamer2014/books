100 REM PRIMES
110 DIM P(200)
120 GOSUB 1100
130 LET X=0:LET Y=10:GOSUB 1700:PRINT "**working**"
140 LET NP=2:LET P(1)=2:LET P(2)=3
150 LET N=5
160 GOSUB 340
170 IF F>0 THEN GOTO 220
180 LET T=0.2:GOSUB 1400
190 LET NP=NP+1
200 LET P(NP)=N
210 LET X=14:LET Y=10:GOSUB 1700:PRINT ;N
220 LET N=N+2
230 IF N<1000 THEN GOTO 160
240 LET X=0:LET Y=10:GOSUB 1700
250 PRINT "enter your number "
260 GOSUB 2100:LET N=K
270 IF N=0 THEN PRINT:STOP
280 IF N<1 OR N>999999 OR N<>INT(N) THEN PRINT "invalid number":PRINT:GOTO 250
290 GOSUB 340
300 IF F=0 THEN PRINT:PRINT "it is prime":GOTO 320
310 PRINT:PRINT "= ";F;" x ";N/F:PRINT:PRINT"and is not prime"
320 PRINT
330 PRINT:GOTO 250
340 LET F=0
350 LET S=SQR(N)
360 FOR I=1 TO NP
370 IF P(I)>S THEN LET I=NP:GOTO 400
380 LET R=N/P(I)
390 IF R=INT(R) THEN LET F=R:LET I=NP
400 NEXT I
410 RETURN
1000 REM VIC20 SUBROUTINES
1100 W=20:D=23
1110 F=8:GOSUB 1200:RETURN
1200 PRINT CHR$(147)
1210 FOR LL=1 TO 8:PRINT:NEXT LL
1220 PRINT;
1230 RETURN
1300 R=INT(RND(1)*N+1):RETURN
1400 FOR Z=1 TO 1000*T:NEXT Z:RETURN
1500 GET G$:IF G$="" THEN 1500
1510 RETURN
1600 GET K$:RETURN
1700 PRINT CHR$(19)
1710 IF Y>0 THEN FOR LL=1 TO Y:PRINT CHR$(17);:NEXT LL
1720 IF X>0 THEN FOR LL=1 TO X:PRINT CHR$(29);:NEXT LL
1730 RETURN
1800 IF X>0 THEN FOR LL=1 TO X:PRINT CHR$(29);:NEXT LL
1810 RETURN
1900 PRINT CHR$(145);:RETURN
2000 PRINT CHR$(29);:RETURN
2100 INPUT K:RETURN
2200 INPUT K$:RETURN
2300 PRINT CHR$(147):RETURN
2400 POKE 36878,15:POKE 36876,Z+128
2410 FOR M=1 TO 50:NEXT M
2420 POKE 36876,0:RETURN
2500 R$=CHR$(R+64):RETURN
2600 P$=MID$(K$,P,1):RETURN
2700 GOSUB 2600:A=ASC(P$):RETURN
2800 PRINT CHR$(147):RETURN
2900 DIM V$(26):RETURN
3000 DIM W$(60):RETURN
3100 GG=ASC(G$):RETURN
